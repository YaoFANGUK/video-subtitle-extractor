ç®€ä½“ä¸­æ–‡ | [English](README_en.md)

## é¡¹ç›®ç®€ä»‹

![License](https://img.shields.io/badge/License-Apache%202-red.svg)
![python version](https://img.shields.io/badge/Python-3.8+-blue.svg)
![support os](https://img.shields.io/badge/OS-Windows/macOS/Linux-green.svg)  

Video-subtitle-extractor (vse) æ˜¯ä¸€æ¬¾å°†è§†é¢‘ä¸­çš„ç¡¬å­—å¹•æå–ä¸ºå¤–æŒ‚å­—å¹•æ–‡ä»¶(srtæ ¼å¼)çš„è½¯ä»¶ã€‚
ä¸»è¦å®ç°äº†ä»¥ä¸‹åŠŸèƒ½ï¼š

- æå–è§†é¢‘ä¸­çš„å…³é”®å¸§
- æ£€æµ‹è§†é¢‘å¸§ä¸­æ–‡æœ¬çš„æ‰€åœ¨ä½ç½®
- è¯†åˆ«è§†é¢‘å¸§ä¸­æ–‡æœ¬çš„å†…å®¹
- è¿‡æ»¤éå­—å¹•åŒºåŸŸçš„æ–‡æœ¬
- [å»é™¤æ°´å°ã€å°æ ‡æ–‡æœ¬ã€åŸè§†é¢‘ç¡¬å­—å¹•ï¼Œå¯é…åˆï¼švideo-subtitle-remover (vsr) ](https://github.com/YaoFANGUK/video-subtitle-remover/tree/main)
- å»é™¤é‡å¤å­—å¹•è¡Œï¼Œç”Ÿæˆsrtå­—å¹•æ–‡ä»¶
- æ”¯æŒè§†é¢‘å­—å¹•**æ‰¹é‡æå–**ï¼ˆæ‰“å¼€æ–‡ä»¶çš„æ—¶å€™é€‰æ‹©å¤šä¸ªè§†é¢‘ï¼‰
- å¤šè¯­è¨€ï¼šæ”¯æŒ**ç®€ä½“ä¸­æ–‡ï¼ˆä¸­è‹±åŒè¯­ï¼‰**ã€**ç¹ä½“ä¸­æ–‡**ã€**è‹±æ–‡**ã€**æ—¥è¯­**ã€**éŸ©è¯­**ã€**è¶Šå—è¯­**ã€**é˜¿æ‹‰ä¼¯è¯­**ã€**æ³•è¯­**ã€**å¾·è¯­**ã€**ä¿„è¯­**ã€**è¥¿ç­ç‰™è¯­**ã€**è‘¡è„ç‰™è¯­**ã€**æ„å¤§åˆ©è¯­**ç­‰**87ç§**è¯­è¨€çš„å­—å¹•æå–
- å¤šæ¨¡å¼ï¼š
  - **å¿«é€Ÿ**ï¼šä½¿ç”¨è½»é‡æ¨¡å‹ï¼Œå¿«é€Ÿæå–å­—å¹•ï¼Œä½†å¯èƒ½ä¸¢å­—å¹•ï¼ˆæ¨èï¼‰
  - **è‡ªåŠ¨**ï¼šè‡ªåŠ¨åˆ¤æ–­æ¨¡å‹ï¼ŒCPUä¸‹ä½¿ç”¨è½»é‡æ¨¡å‹ï¼›GPUä¸‹ä½¿ç”¨ç²¾å‡†æ¨¡å‹ï¼Œæå–å­—å¹•é€Ÿåº¦è¾ƒæ…¢ï¼Œå‡ ä¹ä¸ä¸¢å­—å¹•
  - **ç²¾å‡†**ï¼šä½¿ç”¨ç²¾å‡†æ¨¡å‹ï¼ŒGPUä¸‹é€å¸§æ£€æµ‹ï¼Œä¸ä¸¢å­—å¹•ï¼Œä½†é€Ÿåº¦**éå¸¸æ…¢**ï¼ˆéå¸¸ä¸æ¨èï¼‰

**ä½¿ç”¨è¯´æ˜**ï¼š

- æœ‰ä½¿ç”¨é—®é¢˜è¯·åŠ ç¾¤è®¨è®ºï¼ŒQQç¾¤ï¼š210150985

- è§†é¢‘ä»¥åŠç¨‹åºè·¯å¾„è¯·**ä¸è¦å¸¦ä¸­æ–‡å’Œç©ºæ ¼**ï¼Œå¦åˆ™å¯èƒ½å‡ºç°æœªçŸ¥é”™è¯¯ï¼ï¼ï¼

 > å¦‚ï¼šä»¥ä¸‹å­˜æ”¾è§†é¢‘å’Œä»£ç çš„è·¯å¾„éƒ½ä¸è¡Œ
 >
 > D:\ä¸‹è½½\vse\è¿è¡Œç¨‹åº.exeï¼ˆè·¯å¾„å«ä¸­æ–‡ï¼‰
 >
 > E:\study\kaoyan\sanshang youya.mp4 ï¼ˆè·¯å¾„å«ç©ºæ ¼ï¼‰ 

- ç›´æ¥ä¸‹è½½å‹ç¼©åŒ…è§£å‹è¿è¡Œï¼Œå¦‚æœä¸èƒ½è¿è¡Œå†æŒ‰ç…§ä¸‹é¢çš„æ•™ç¨‹ï¼Œå°è¯•æºç å®‰è£…condaç¯å¢ƒè¿è¡Œ

**ä¸‹è½½åœ°å€**ï¼š

- Windows ç»¿è‰²ç‰ˆæœ¬v2.0.0ï¼ˆCPUï¼‰ï¼š <a href="https://pan.baidu.com/s/1aUtZqGix1J0aqwGX4VRCWA?pwd=vse2" target=_blank>vse_windows_cpu_v2.0.0.zip</a> æå–ç ï¼š**vse2** 

> **æ¨èä½¿ç”¨ï¼Œå¯åŠ¨é€Ÿåº¦è¾ƒå¿«**

- Windows å•æ–‡ä»¶ç‰ˆæœ¬v2.0.0ï¼ˆCPUï¼‰ï¼š <a href=https://www.aliyundrive.com/s/uD5ZfoAbDcf target=_blank>vse.exe</a> æå–ç ï¼š**rl02** 

> åŒå‡»ç›´æ¥è¿è¡Œï¼Œæ¯æ¬¡æ‰“å¼€æ—¶ä¼šæœ‰ä¸€ç‚¹æ…¢ï¼Œ**è‹¥å‡ºç°è¯¯æŠ¥æ¯’ï¼Œä½¿ç”¨ç»¿è‰²ç‰ˆ**

- Windows GPUç‰ˆæœ¬v2.0.0ï¼ˆGPUï¼‰ï¼š <a href="https://pan.baidu.com/s/1w8vJnqF91RlJB39LMbZmDg?pwd=vse2">vse_windows_gpu_v2.0.0.7z</a> æå–ç ï¼š**vse2**

> **ä»…ä¾›å…·æœ‰Nvidiaæ˜¾å¡çš„ç”¨æˆ·ä½¿ç”¨(AMDçš„æ˜¾å¡ä¸è¡Œ)ï¼Œæå–é€Ÿåº¦éå¸¸å¿«**

- MacOS ç‰ˆæœ¬v0.1.0ï¼ˆCPUï¼‰ï¼š <a href="https://pan.baidu.com/s/1WgZpr_8I3Dv7A8ThwcIPng">vse_macOS_CPU.dmg</a> æå–ç ï¼š**7gbo** 

> PS: è‹¥æ— æ³•ä¸‹è½½ï¼Œè¯·å‰å¾€<a href="https://github.com/YaoFANGUK/video-subtitle-extractor/releases"> Release </a>ä¸‹è½½


## é¡¹ç›®ç‰¹è‰²

- é‡‡ç”¨æœ¬åœ°è¿›è¡ŒOCRè¯†åˆ«ï¼Œæ— éœ€è®¾ç½®è°ƒç”¨ä»»ä½•APIï¼Œä¸éœ€è¦æ¥å…¥ç™¾åº¦ã€é˜¿é‡Œç­‰åœ¨çº¿OCRæœåŠ¡å³å¯æœ¬åœ°å®Œæˆæ–‡æœ¬è¯†åˆ«
- æ”¯æŒGPUåŠ é€Ÿï¼ŒGPUåŠ é€Ÿåå¯ä»¥è·å¾—æ›´é«˜çš„å‡†ç¡®ç‡ä¸æ›´å¿«çš„æå–é€Ÿåº¦
- (CLIç‰ˆæœ¬) æ— éœ€ç”¨æˆ·æ‰‹åŠ¨è®¾ç½®å­—å¹•åŒºåŸŸï¼Œé¡¹ç›®é€šè¿‡æ–‡æœ¬æ£€æµ‹æ¨¡å‹è‡ªåŠ¨æ£€æµ‹å­—å¹•åŒºåŸŸ
- (GUIç‰ˆæœ¬) å›¾å½¢åŒ–ç•Œé¢

<p style="text-align:center;"><img src="https://github.com/YaoFANGUK/video-subtitle-extractor/raw/main/design/demo.png" alt="demo.png"/></p>


ç‚¹å‡»ã€æ‰“å¼€ã€‘åé€‰æ‹©è§†é¢‘æ–‡ä»¶ï¼Œè°ƒæ•´å­—å¹•åŒºåŸŸï¼Œç‚¹å‡»ã€è¿è¡Œã€‘

> **æœ‰ä»»ä½•æ”¹è¿›æ„è§è¯·åœ¨ISSUESä¸­æå‡º**



## æ¼”ç¤º

- GUIç‰ˆï¼š

<p style="text-align:center;"><img src="https://github.com/YaoFANGUK/video-subtitle-extractor/raw/main/design/demo.gif" alt="demo.gif"/></p>

- ç‚¹å‡»æŸ¥çœ‹è§†é¢‘æ•™ç¨‹ ğŸ‘‡

[![GPUç‰ˆæœ¬å®‰è£…æ•™ç¨‹](https://s1.ax1x.com/2022/04/15/L3KzLR.png)](https://www.bilibili.com/video/bv11L4y1Y7Tj "GUPç‰ˆæœ¬å®‰è£…æ•™ç¨‹")



## åœ¨çº¿è¿è¡Œ

- ä½¿ç”¨**Google Colab Notebook**(å…è´¹GPU): <a href="https://colab.research.google.com/github/YaoFANGUK/video-subtitle-extractor/blob/main/google_colab.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a>

> PS: Google Colabåªèƒ½è¿è¡ŒCLIç‰ˆæœ¬



## æºç ä½¿ç”¨è¯´æ˜

#### 1. ä¸‹è½½å®‰è£…Miniconda 

- Windows: <a href="https://repo.anaconda.com/miniconda/Miniconda3-py38_4.11.0-Windows-x86_64.exe">Miniconda3-py38_4.11.0-Windows-x86_64.exe</a>


- MacOSï¼š<a href="https://repo.anaconda.com/miniconda/Miniconda3-py38_4.11.0-MacOSX-x86_64.pkg">Miniconda3-py38_4.11.0-MacOSX-x86_64.pkg</a>


- Linux: <a href="https://repo.anaconda.com/miniconda/Miniconda3-py38_4.11.0-Linux-x86_64.sh">Miniconda3-py38_4.11.0-Linux-x86_64.sh</a>

#### 2. åˆ›å»ºå¹¶æ¿€æ´»è™šæœºç¯å¢ƒ

ï¼ˆ1ï¼‰åˆ‡æ¢åˆ°æºç æ‰€åœ¨ç›®å½•ï¼š
```shell
cd <æºç æ‰€åœ¨ç›®å½•>
```
> ä¾‹å¦‚ï¼šå¦‚æœä½ çš„æºä»£ç æ”¾åœ¨Dç›˜çš„toolsæ–‡ä»¶ä¸‹ï¼Œå¹¶ä¸”æºä»£ç çš„æ–‡ä»¶å¤¹åä¸ºvideo-subtitle-extractorï¼Œå°±è¾“å…¥ ```cd D:/tools/video-subtitle-extractor-main```

ï¼ˆ2ï¼‰åˆ›å»ºæ¿€æ´»condaç¯å¢ƒ
```shell
conda create -n videoEnv python=3.8
```

```shell
conda activate videoEnv
```

#### 3. å®‰è£…ä¾èµ–æ–‡ä»¶

è¯·ç¡®ä¿ä½ å·²ç»å®‰è£… python 3.8+ï¼Œä½¿ç”¨condaåˆ›å»ºé¡¹ç›®è™šæ‹Ÿç¯å¢ƒå¹¶æ¿€æ´»ç¯å¢ƒ (å»ºè®®åˆ›å»ºè™šæ‹Ÿç¯å¢ƒè¿è¡Œï¼Œä»¥å…åç»­å‡ºç°é—®é¢˜)

- CPUç”¨æˆ· (Macç”¨æˆ·) : 

  - å®‰è£…ä¾èµ–ï¼š
    ```shell
    pip install -r requirements.txt
    ```

- GPUç”¨æˆ·(æœ‰Nå¡)ï¼š **è¦è¾¾åˆ°é«˜ç²¾åº¦çš„è¯†åˆ«ç‡è¯·ä½¿ç”¨GPUç‰ˆ**
  
  - å®‰è£…CUDAå’ŒcuDNN

    <details>
        <summary>Linuxç”¨æˆ·</summary>
        <h5>(1) ä¸‹è½½CUDA 11.7</h5>
        <pre><code>wget https://developer.download.nvidia.com/compute/cuda/11.7.0/local_installers/cuda_11.7.0_515.43.04_linux.run</code></pre>
        <h5>(2) å®‰è£…CUDA 11.7</h5>
        <pre><code>sudo sh cuda_11.7.0_515.43.04_linux.run</code></pre>
        <p>1. è¾“å…¥accept</p>
        <img src="https://i.328888.xyz/2023/03/31/iwVoeH.png" width="500" alt="">
        <p>2. é€‰ä¸­CUDA Toolkit 11.7ï¼ˆå¦‚æœä½ æ²¡æœ‰å®‰è£…nvidiaé©±åŠ¨åˆ™é€‰ä¸­Driverï¼Œå¦‚æœä½ å·²ç»å®‰è£…äº†nvidiaé©±åŠ¨è¯·ä¸è¦é€‰ä¸­driverï¼‰ï¼Œä¹‹åé€‰ä¸­installï¼Œå›è½¦</p>
        <img src="https://i.328888.xyz/2023/03/31/iwVThJ.png" width="500" alt="">
        <p>3. æ·»åŠ ç¯å¢ƒå˜é‡</p>
        <p>åœ¨ ~/.bashrc åŠ å…¥ä»¥ä¸‹å†…å®¹</p>
        <pre><code># CUDA
    export PATH=/usr/local/cuda-11.7/bin${PATH:+:${PATH}}
    export LD_LIBRARY_PATH=/usr/local/cuda-11.7/lib64${LD_LIBRARY_PATH:+:${LD_LIBRARY_PATH}}</code></pre>
        <p>ä½¿å…¶ç”Ÿæ•ˆ</p>
        <pre><code>source ~/.bashrc</code></pre>
        <h5>(3) ä¸‹è½½cuDNN 8.4.1</h5>
        <p>å›½å†…ï¼š<a href="https://pan.baidu.com/s/1Gd_pSVzWfX1G7zCuqz6YYA">cudnn-linux-x86_64-8.4.1.50_cuda11.6-archive.tar.xz</a> æå–ç ï¼š57mg</p>
        <p>å›½å¤–ï¼š<a href="https://github.com/YaoFANGUK/video-subtitle-extractor/releases/download/1.0.0/cudnn-linux-x86_64-8.4.1.50_cuda11.6-archive.tar.xz">cudnn-linux-x86_64-8.4.1.50_cuda11.6-archive.tar.xz</a></p>
        <h5>(4) å®‰è£…cuDNN 8.4.1</h5>
        <pre><code> tar -xf cudnn-linux-x86_64-8.4.1.50_cuda11.6-archive.tar.xz
     mv cudnn-linux-x86_64-8.4.1.50_cuda11.6-archive cuda
     sudo cp ./cuda/include/* /usr/local/cuda-11.7/include/
     sudo cp ./cuda/lib/* /usr/local/cuda-11.7/lib64/
     sudo chmod a+r /usr/local/cuda-11.7/lib64/*
     sudo chmod a+r /usr/local/cuda-11.7/include/*</code></pre>
    </details>
  
    <details>
          <summary>Windowsç”¨æˆ·</summary>
          <h5>(1) ä¸‹è½½CUDA 11.7</h5>
          <a href="https://developer.download.nvidia.com/compute/cuda/11.7.0/local_installers/cuda_11.7.0_516.01_windows.exe">cuda_11.7.0_516.01_windows.exe</a>
          <h5>(2) å®‰è£…CUDA 11.7</h5>
          <h5>(3) ä¸‹è½½cuDNN 8.2.4</h5>
          <p><a href="https://github.com/YaoFANGUK/video-subtitle-extractor/releases/download/1.0.0/cudnn-windows-x64-v8.2.4.15.zip">cudnn-windows-x64-v8.2.4.15.zip</a></p>
          <h5>(4) å®‰è£…cuDNN 8.2.4</h5>
          <p>
             å°†cuDNNè§£å‹åçš„cudaæ–‡ä»¶å¤¹ä¸­çš„bin, include, libç›®å½•ä¸‹çš„æ–‡ä»¶å¤åˆ¶åˆ°C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.7\å¯¹åº”ç›®å½•ä¸‹
          </p>
      </details>


  - å®‰è£…paddlepaddle:

    - windows:

        ```shell 
        python -m pip install paddlepaddle-gpu==2.4.2.post117 -f https://www.paddlepaddle.org.cn/whl/windows/mkl/avx/stable.html
        ```

    - Linux:

        ```shell
        python -m pip install paddlepaddle-gpu==2.4.2.post117 -f https://www.paddlepaddle.org.cn/whl/linux/mkl/avx/stable.html
        ```

        > å¦‚æœå®‰è£…cuda 10.2ï¼Œè¯·å¯¹åº”å®‰è£…7.6.5çš„cuDNNï¼Œå¹¶ä½¿ç”¨å¯¹åº”cudaç‰ˆæœ¬çš„paddlepaddleï¼Œ**è¯·ä¸è¦ä½¿ç”¨cuDNN v8.x å’Œ cuda 10.2çš„ç»„åˆ**
 
        > å¦‚æœå®‰è£…cuda 11.2ï¼Œè¯·å¯¹åº”å®‰è£…8.1.1çš„cuDNNï¼Œå¹¶ä½¿ç”¨å¯¹åº”cudaç‰ˆæœ¬çš„paddlepaddleï¼Œ**30ç³»åˆ—ä»¥ä¸Šçš„æ˜¾å¡é©±åŠ¨å¯èƒ½ä¸æ”¯æŒ cuda 11.2åŠä»¥ä¸‹ç‰ˆæœ¬çš„å®‰è£…**  


  - å®‰è£…å…¶ä»–ä¾èµ–:

    ```shell
    pip install -r requirements_gpu.txt
    ```
  

#### 4. è¿è¡Œç¨‹åº

- è¿è¡Œå›¾å½¢åŒ–ç•Œé¢ç‰ˆæœ¬(GUI)

```shell
python gui.py
```

- è¿è¡Œå‘½ä»¤è¡Œç‰ˆæœ¬(CLI)

```shell
python ./backend/main.py
```



## å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

#### 1. è¿è¡Œä¸æ­£å¸¸/æ²¡æœ‰ç»“æœ/cudaåŠcudnné—®é¢˜

è§£å†³æ–¹æ¡ˆï¼šæ ¹æ®è‡ªå·±çš„æ˜¾å¡å‹å·ã€æ˜¾å¡é©±åŠ¨ç‰ˆæœ¬ï¼Œå®‰è£…å¯¹åº”çš„cudaä¸cudnn


#### 2. CondaHTTPError

å°†é¡¹ç›®ä¸­çš„.condarcæ”¾åœ¨ç”¨æˆ·ç›®å½•ä¸‹(C:\Users\\<ä½ çš„ç”¨æˆ·å>)ï¼Œå¦‚æœç”¨æˆ·ç›®å½•å·²ç»å­˜åœ¨è¯¥æ–‡ä»¶åˆ™è¦†ç›–

è§£å†³æ–¹æ¡ˆï¼š<a href="https://zhuanlan.zhihu.com/p/260034241">https://zhuanlan.zhihu.com/p/260034241 </a>

#### 3. Windowsä¸‹å‡ºç°geos_c.dllé”™è¯¯

```text
    _lgeos = CDLL(os.path.join(sys.prefix, 'Library', 'bin', 'geos_c.dll'))
  File "C:\Users\Flavi\anaconda3\envs\subEnv\lib\ctypes\__init__.py", line 364, in __init__
    self._handle = _dlopen(self._name, mode)
OSError: [WinError 126] æ‰¾ä¸åˆ°æŒ‡å®šçš„æ¨¡å—ã€‚
```

è§£å†³æ–¹æ¡ˆï¼š

(1) å¸è½½Shapely

```shell
pip uninstall Shapely -y
```

(2) ä½¿ç”¨condaé‡æ–°å®‰è£…Shapely

```shell
conda install Shapely             
```

#### 4. 7zæ–‡ä»¶è§£å‹é”™è¯¯

è§£å†³æ–¹æ¡ˆï¼šå‡çº§7-zipè§£å‹ç¨‹åºåˆ°æœ€æ–°ç‰ˆæœ¬

#### 5. Nuitkaæ‰“åŒ…ä»£ç é—ªé€€

ä½¿ç”¨Nuitkaç‰ˆæœ¬```0.6.19```ï¼Œå°†condaè™šæ‹Ÿç¯å¢ƒLibæ–‡ä»¶å¤¹ä¸‹site-packagesçš„æ‰€æœ‰æ–‡ä»¶å¤åˆ¶åˆ°dependenciesæ–‡ä»¶å¤¹ä¸­ï¼ŒæŠŠpaddleåº“datasetä¸‹image.pyçš„æœ‰å…³subprocessä»£ç å…¨éƒ¨æ³¨é‡Šäº†ï¼Œä½¿ç”¨ä»¥ä¸‹æ‰“åŒ…å‘½ä»¤ï¼š

```shell
 python -m nuitka --standalone --mingw64 --include-data-dir=D:\vse\backend=backend --include-data-dir=D:\vse\dependencies=dependencies  --nofollow-imports --windows-icon-from-ico=D:\vse\design\vse.ico --plugin-enable=tk-inter,multiprocessing --output-dir=out .\gui.py
```

ç¼–è¯‘æˆå•ä¸ªæ–‡ä»¶ï¼ˆpipå®‰è£…zstandardå¯ä»¥å‡å°ä½“ç§¯ï¼‰
```shell
python -m nuitka --standalone --windows-disable-console --mingw64 --lto no --include-data-dir=C:\Users\Yao\Downloads\vse\backend=backend --include-data-dir=C:\Users\Yao\Downloads\vse\design=design --include-data-dir=C:\Users\Yao\Downloads\vse\dependencies=dependencies  --nofollow-imports --windows-icon-from-ico=C:\Users\Yao\Downloads\vse\design\vse.ico --plugin-enable=tk-inter,multiprocessing --output-dir=C:\Users\Yao\Downloads\out --onefile .\gui.py
```

## ç¤¾åŒºæ”¯æŒ

#### Jetbrains å…¨å®¶æ¡¶æ”¯æŒ
æœ¬é¡¹ç›®å¼€å‘æ‰€ä½¿ç”¨çš„IDEç”±Jetbrainsæ”¯æŒã€‚
<div align=center>
  <a href="https://jb.gg/OpenSourceSupport"><img src="https://resources.jetbrains.com/storage/products/company/brand/logos/jb_beam.png" alt="JetBrains Logo (Main) logo." width="80"></a>
</div>

## èµåŠ©
<img src="https://i.imgur.com/THE81jM.jpg" width="300">

| æèµ è€… | ç´¯è®¡æèµ é‡‘é¢ | èµåŠ©å¸­ä½ |
| --- | --- | --- |
| çˆ±ä¸œ| 100.00 RMB | é‡‘ç‰ŒèµåŠ©å¸­ä½ |
| [neoyxm](https://github.com/neoyxm) | 50.00 RMB | é“¶ç‰ŒèµåŠ©å¸­ä½ |
| [AcelXiao](https://github.com/acelxiao) | 20.00 RMB | é“¶ç‰ŒèµåŠ©å¸­ä½ |
| sky | 5.00 RMB | é“œç‰ŒèµåŠ©å¸­ä½ |
